{% extends 'store/main.html' %}
{% load static %}
{% block content %}
<!--payment-->
<div class="col-12">
  <div class="row">
    <div class="col-md-6" id="saved-payment-methods">
      {% if not editing %}
      <!-- This is where the rendering and loop for displaying shippinginfo goes-->
      <h3> Saved Shipping Methods: </h3>
      {% for shipping in shipping_info %}
      <!-- This is where the program iterates through all the user's shipping methods -->
      <div class="col-6">
        Street: {{ shipping.street }}<br>
        City: {{ shipping.city }}<br>
        State: {{ shipping.state }}<br>
        Zipcode: {{ shipping.zipcode }}<br>
        Country: {{ shipping.country }}<br>
        
        <br>
        <form method="post" action="{% url 'shipping_methods' %}">
          {% csrf_token %}
          <input type="hidden" name="edit_shipping_id" value="{{ shipping.id }}">
          <button type="submit" name="action" value="show_edit_shipping_form">Edit</button>
        </form>
        <form method="post" action="{% url 'shipping_methods' %}">
          {% csrf_token %}
          <input type="hidden" name="delete_shipping_id" value="{{ shipping.id }}">
          <button type="submit">Delete</button>
        </form>
      </div>
      {% empty %}
      <div class="col-md-6">
        <h6> There are no shipping methods saved. Please add a shipping method.</h6>
      </div>
      {% endfor %}

      {% endif %}

      {% if editing %}
      <!-- Displays the Edit Shipping Form -->
      <h3> Edit Shipping Method:</h3>
      <form method="post" action="{% url 'shipping_methods' %}">
        {% csrf_token %}
        <input type="hidden" name="edit_shipping_id" value="{{ shipping.id }}">
        <div class="col-6">
          Street:
          <input type="text" name="street" class="form-control" value="{{ shipping.street }}">
          <br>
          City:
          <input type="text" name="city" class="form-control" value="{{ shipping.city }}">
          <br>
          State:
          <input type="text" name="state" class="form-control" value="{{ shipping.state }}">
          <br>
          Zipcode:
          <input type="text" name="zipcode" class="form-control" value="{{ shipping.zipcode }}">
          <br>
          Country:
          <input type="text" name="country" class="form-control" placeholder="Country" value="{{ shipping.country }}">
          <br>
          Default:
          <input type="checkbox" name="is_default" class="form-control" value ="{{ shipping.is_default }}">
          <br>
        </div>
        <button type="submit" name="action" value="process_edit_shipping_form">Save Changes</button>
      </form>
      {% endif %}
    </div> <!-- This ends the section for showing/editing saved shipping methods -->

    {% if not adding %}
    <!-- Shows the button for adding a shipping so no bugs occur with multiple forms being rendered -->
    <form method="post" action="{% url 'shipping_methods' %}">  
      {% csrf_token %}
      <input type="hidden" name="action" value="show_add_shipping_form">
      <button type="submit">Add Shipping</button>
    </form>
    {% endif %}

    {% if adding %}
    <!-- This is displays the add shipping form -->
    <div class="col-md-6" id="add-shipping-form">
      <h3> Add a Shipping Method: </h3>
      <form method="post" action="{% url 'shipping_methods' %}">  
        {% csrf_token %}
        <input type="hidden" name="action" value="process_add_shipping">
        <div class="form-group" id="street">
          <label for="street">Street</label>
          <input type="text" id="street" name="street" class="form-control" placeholder="Street">
        </div>
        <div class="form-group" id="city">
          <label for="city">City</label>
          <input type="text" id="city" name="city" class="form-control" placeholder="City">
        </div>
        <div class="form-group" id="state">
          <label for="state">State</label>
          <input type="text" id="state" name="state" class="form-control" placeholder="State">
        </div>
        <div class="form-group" id="zipcode">
          <label for="zipcode">Zipcode</label>
          <input type="number" id="zipcode" name="zipcode" class="form-control" placeholder="Zipcode">
        </div>
        <div class="form-group" id="country">
          <label for="country">Country</label>
          <input type="text" id="country" name="country" class="form-control" placeholder="Country">
        </div>
        <div class="form-group" id="is_default">
          <label for="is_default">
            <input type="checkbox" id="is_default" name="is_default" class="form-check-label"> Default
          </label>
        </div>
        <button id="form-button" type="submit" class="btn btn-primary">Submit</button>
      </form>
    </div>
    {% endif %}
    {% if messages %}
    {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
        {% endfor %}
        {% endif %}
  </div> <!-- Div that is connected to the rows that hold both the add shipping and saved shipping -->
</div>

{% endblock %}
